# Path to Oh My Zsh installation
export ZSH="$HOME/.oh-my-zsh"

# Plugins
plugins=(git z zsh-vi-mode zsh-syntax-highlighting zsh-autosuggestions gh kind rust kubectl terraform)

source $ZSH/oh-my-zsh.sh

# History settings
HISTSIZE=50000
SAVEHIST=50000
setopt SHARE_HISTORY
setopt HIST_IGNORE_ALL_DUPS

# Editor
export EDITOR='nvim'

# Aliases
alias mvc="uv tool run mvc"
alias training-launcher="uv tool run --from mvc training-launcher"
alias ls='eza'
alias cat='bat'
alias find='fd'

# PATH
export PATH=$PATH:/opt/homebrew/share/google-cloud-sdk/bin
export PATH="${KREW_ROOT:-$HOME/.krew}/bin:$PATH"

# Secrets (API keys, etc.)
[[ -f ~/.secrets ]] && source ~/.secrets

# Tools
eval "$(/Users/mikhail.dyakov/.local/bin/mise activate zsh)"
eval "$(gh copilot alias -- zsh)"

# zsh-vi-mode: sync yank to system clipboard
for f in zvm_backward_kill_region zvm_yank zvm_replace_selection zvm_change_surround_text_object zvm_vi_delete zvm_vi_change zvm_vi_change_eol; do
  eval "$(echo "_$f() {"; declare -f $f | tail -n +2)"
  eval "$f() { _$f \"\$@\"; echo -en \$CUTBUFFER | pbcopy }"
done

# broot
source /Users/mikhail.dyakov/.config/broot/launcher/bash/br

# fzf (Ctrl+R for history, Ctrl+T for files, Alt+C for cd)
# Must be initialized after zsh-vi-mode
zvm_after_init() {
  source <(fzf --zsh)
}

# Starship prompt (must be at the end)
eval "$(starship init zsh)"
